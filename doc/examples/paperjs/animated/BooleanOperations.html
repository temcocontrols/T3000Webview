<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Boolean Operations</title>
  <link rel="stylesheet" href="doc/examples/paperjs/css/style.css">
  <script type="text/javascript" src="doc/examples/paperjs/dist/paper-full.js"></script>
  <script type="text/paperscript" canvas="canvas">
        var text = new PointText({
            position: view.center + [0, 200],
            fillColor: 'black',
            justification: 'center',
            fontSize: 20
        });

        var originals = new Group({ insert: false }); // Don't insert in DOM.

        var square = new Path.Rectangle({
            position: view.center,
            size: 300,
            parent: originals,
            fillColor: 'white'
        });

        // Make a ring using subtraction of two circles:
        var inner = new Path.Circle({
            center: view.center,
            radius: 100,
            parent: originals,
            fillColor: 'white'
        });

        var outer = new Path.Circle({
            center: view.center,
            radius: 140,
            parent: originals,
            fillColor: 'white'
        });

        var ring = outer.subtract(inner);

        var operations = ['unite', 'intersect', 'subtract', 'exclude', 'divide'];
        var colors = ['red', 'green', 'blue', 'black'];
        var curIndex = -1;
        var operation, result, activeItem;

        // Change the mode every 3 seconds:
        setInterval(setMode, 3000);

        // Set the initial mode:
        setMode();

        function setMode() {
            curIndex++;
            if (curIndex == operations.length * 2)
                curIndex = 0;
            operation = operations[curIndex % operations.length];
        }

        function onMouseDown(event) {
            var hitResult = originals.hitTest(event.point);
            activeItem = hitResult && hitResult.item;
        }

        function onMouseDrag(event) {
            if (activeItem)
                activeItem.position = event.point;
        }

        function onMouseUp() {
            activeItem = null;
            square.position = view.center;
        }

        function onFrame(event) {
            if (activeItem != ring) {
                // Move the ring around:
                var offset = new Point(140, 80) * [Math.sin(event.count / 60), Math.sin(event.count / 40)];
                ring.position = view.center + offset;
            }

            // Remove the result of the last path operation:
            if (result)
                result.remove();

            // Perform the path operation on the ring:
            if (curIndex < operations.length) {
                result = square[operation](ring);
                console.log(result);
                text.content = 'square.' + operation + '(ring)';
            } else {
                result = ring[operation](square);
                console.log(result);
                text.content = 'ring.' + operation + '(square)';
            }
            result.selected = true;
            <!-- result.fillColor = colors[curIndex % colors.length]; -->
            result.moveBelow(text);

            // If the result is a group, color each of its children differently:
            if (result instanceof Group) {
                for (var i = 0; i < result.children.length; i++) {
                    result.children[i].fillColor = colors[i];
                }
            }
        };

        function onResize() {
            text.position = view.center + [0, 200];
            square.position = view.center;
        }


        // Load extra svg from file
        var file = document.getElementById('file');
                file.addEventListener('change', function (event) {
                    var files = event.target.files;
                    for (var i = 0; i < files.length; i++) {
                        var file = files[i];
                        if (file.type.match('svg')) {
                            <!-- project.clear(); -->
                            project.importSVG(file, function(item) {
                                console.log(item);
                            });
                        }
                    }
          });

    </script>
</head>

<body>

  <!-- project.importSVG(document.getElementById('svg'), {
    applyMatrix: false
});  -->

  <form>
    <input type="file" id="file">
  </form>

  <canvas id="canvas" resize stats></canvas>

  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1000"
    height="500" id="svg" viewBox="0 0 1000 500">
    <g transform="scale(0.5)">
      <path d="M300,200 h-150 a150,150 0 1,0 150,-150 z" fill="red" stroke="blue" stroke-width="5" />
      <path d="M275,175 v-150 a150,150 0 0,0 -150,150 z" fill="yellow" stroke="blue" stroke-width="5" />
      <path d="M600,350 l 50,-25
                         a25,25 -30 0,1 50,-25 l 50,-25
                         a25,50 -30 0,1 50,-25 l 50,-25
                         a25,75 -30 0,1 50,-25 l 50,-25
                         a25,100 -30 0,1 50,-25 l 50,-25" fill="none" stroke="red" stroke-width="5" />
      <g font-family="Verdana" transform="translate(0,400)">
        <defs>
          <g id="baseEllipses" font-size="20">
            <ellipse cx="125" cy="125" rx="100" ry="50" fill="none" stroke="#888888" stroke-width="2" />
            <ellipse cx="225" cy="75" rx="100" ry="50" fill="none" stroke="#888888" stroke-width="2" />
            <text x="35" y="70">Arc start</text>
            <text x="225" y="145">Arc end</text>
          </g>
        </defs>
        <rect x="1" y="1" width="1198" height="523" fill="none" stroke="blue" stroke-width="1" />

        <g font-size="30">
          <g transform="translate(0,0)">
            <use xlink:href="#baseEllipses" />
          </g>
          <g transform="translate(400,0)">
            <text x="50" y="210">large-arc-flag=0</text>
            <text x="50" y="250">sweep-flag=0</text>
            <use xlink:href="#baseEllipses" />
            <path d="M 125,75 a100,50 0 0,0 100,50" fill="none" stroke="red" stroke-width="6" />
          </g>
          <g transform="translate(800,0)">
            <text x="50" y="210">large-arc-flag=0</text>
            <text x="50" y="250">sweep-flag=1</text>
            <use xlink:href="#baseEllipses" />
            <path d="M 125,75 a100,50 0 0,1 100,50" fill="none" stroke="red" stroke-width="6" />
          </g>
          <g transform="translate(400,250)">
            <text x="50" y="210">large-arc-flag=1</text>
            <text x="50" y="250">sweep-flag=0</text>
            <use xlink:href="#baseEllipses" />
            <path d="M 125,75 a100,50 0 1,0 100,50" fill="none" stroke="red" stroke-width="6" />
          </g>
          <g transform="translate(800,250)">
            <text x="50" y="210">large-arc-flag=1</text>
            <text x="50" y="250">sweep-flag=1</text>
            <use xlink:href="#baseEllipses" />
            <path d="M 125,75 a100,50 0 1,1 100,50" fill="none" stroke="red" stroke-width="6" />
          </g>
        </g>
      </g>
    </g>
  </svg>
</body>

</html>
